# This file is generated by the template.

REGISTRY?=cr.loongnix.cn
ORGANIZATION?=zabbix
REPOSITORY?=zabbix-web-apache-mysql
TAG?=alpine-5.0.2

IMAGE=$(REGISTRY)/$(ORGANIZATION)/$(REPOSITORY):$(TAG)

MAJOR_VERSION=5.0
ZBX_VERSION=$(MAJOR_VERSION).2
ZBX_SOURCES?=https://git.zabbix.com/scm/zbx/zabbix.git

default: image

zabbix-5.0.2:
	export GIT_SSL_NO_VERIFY=1 && \
	git clone $(ZBX_SOURCES) --branch $(ZBX_VERSION) --depth=1 --single-branch zabbix-$(ZBX_VERSION)

image: zabbix-5.0.2
	docker build \
		-t $(IMAGE) \
		.

push:
	docker push $(IMAGE)
