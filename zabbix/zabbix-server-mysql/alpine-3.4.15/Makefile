# This file is generated by the template.

REGISTRY?=cr.loongnix.cn
ORGANIZATION?=zabbix
REPOSITORY?=zabbix-server-mysql
TAG?=alpine-3.4.15

ZBX_SOURCES?=https://git.zabbix.com/scm/zbx/zabbix.git
ZBX_VERSION?=3.4.15

IMAGE=$(REGISTRY)/$(ORGANIZATION)/$(REPOSITORY):$(TAG)


default: image

zabbix-3.4.15:
	export GIT_SSL_NO_VERIFY=1 && \
	git clone $(ZBX_SOURCES) --branch $(ZBX_VERSION) --depth=1 --single-branch zabbix

image: zabbix-3.4.15
	./build.sh latest build $(REGISTRY)/$(ORGANIZATION)

push:
	docker push $(IMAGE)
